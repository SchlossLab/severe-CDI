#Copies clinical CDI sample sequence data files from miseq_runs folder in schloss-lab turbo storage to my CDI_clinical_samples project directory. This script is a record of bash commands used, since it is just moving/renaming files there is no need to submit as a job. For each library, the water & mock fastqs will be renamed to match the CDI plate number they were in.
#Note: We start off at plate 5, because 376 samples had already been sequenced by Micah and the microbiome core. Separate aliquots of each of those 376 samples were sequenced by the Schloss lab so that all 3943 samples are represented below.)

#This file will just copy the sequences for 1 library of samples in order to test and debug mothur v1.44 since I had been getting a segmentation fault

#After logging onto Great lakes go to labs turbo storage:
cd /nfs/turbo/schloss-lab

#Library for plates 5-8
#Copy raw data files into CDI_clinical_samples directory for data analysis
cp miseq_runs/2019_runs/SarahCDIp5-p8_Aug2019/Data/Intensities/BaseCalls/*.fastq.gz tomkoset/CDI_clinical_samples/data/test_raw/
#Change into test_raw data directory
cd tomkoset/CDI_clinical_samples/data/test_raw/
# Rename #Mock & water controls to match the plate number they were in
rename 'mock1_' mock5_ *.gz
rename 'Mock2_' mock6_ *.gz
rename 'mock3_' mock7_ *.gz
rename 'Mock-w-KR00350-M2-contamination' mock8contamKR00350 *.gz
rename 'water1_' water5_ *.gz
rename 'water2_' water6_ *.gz
rename 'water3_' water7_ *.gz
rename 'water4_' water8_ *.gz
#Remove Undetermined fastq.gz filenames
rm Undetermined*.fastq.gz
#Remove contaminated mock sample since we can't use it since its a mix of mock and another sample
rm mock8contamKR00350*.fastq.gz

#Remove -PBS and -M# from .gz filenames for all samples (do these steps once sequences from all libraries have been transferred to test_raw data folder). This information is already recorded in the corresponding metadata file.
#First remove dashes before removing each remaining combination. Removes the dashes before M# and PBS.
for file in *.gz; do mv "$file" "$(echo "$file" | sed 's/-/'""'/g')"; done
# Remove PBS from sample id
rename 'PBS_' _ *.gz
# Now remove M1, M2, and M3 (denotes the 3 different microbiome aliquots that were stored per sample) from sample id
rename 'M1_' _ *.gz
rename 'M2_' _ *.gz
rename 'M3_' _ *.gz
